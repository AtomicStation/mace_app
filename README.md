# MaceCV -- An Mace Action Detection Application

## Description

A lot of current, popular fitness modalities deal with movements that are either up and down (squats, deadlifts) or front and back (bench press). Not a lot of exercises deal with side to side movements. The steel mace is an offset weight on a long handle, which allows for unique opportunities. Steel mace training provides enhanced grip strength, improved core strength and stabilization, increased range of motion, better shoulder health, and fun!

The offset nature of the weight means that momentum is used during the swings. The "float" means that the steel mace swing can also be used to train strength-endurance. Endurance activities like running have technologies that utilize GPS tracking and time, which results in accurate metrics for assessing training volume. For steel mace swings, time and swing repetitions are required for volume (swings per minute, swings per hour, etc). However, for long sessions, mentally keeping track of swing repetitions becomes nearly impossible.

This project was designed with this problem in mind: using computer vision techniques to count reps for steel mace swings.

Currently, the project uses OpenCV and MediaPipe pose estimation data to train a LSTM RNN model to detect swings. Kivy is used to make the project into a mobile application.

[![Watch the video](https://img.youtube.com/vi/NzxdYJMnTzM/0.jpg)](https://www.youtube.com/shorts/NzxdYJMnTzM).

## Table of Contents (Optional)
- [Motivation](#motivation)
- [Installation](#installation)
- [Usage](#usage)
- [References and Credits](#credits)
- [License](#license)

## Motivation

I was motivated to start this project because the steel mace is a relatively unknown training tool, and while other AI-powered fitness apps exists, the steel mace is too niche to be offered.

## Installation

This project imports the following libraries:
- kivy (Kivy) -- Handles the app functions
- cv2 (OpenCV) -- Computer Vision library
- mediapipe (MediaPipe) -- Pose Estimation library
- tensoflow.keras (TensorFlow) -- Deep Learning model that does action prediction

Other supporting libraries:
- numpy
- matplotlib
- scipi


## Usage

Information on each file:
- videos/ - directory with videos for testing custom action detection model
- app.py - Main Kivy application
- custom_model.py - Functions used for generating data, training, and predicting
- gen_train_data.py - Generates data used for the custom action detection model
- maceCV_weights.h5 - Pretrained weights used by custom action detection model
- macecv.kv - Kivy file for the application
- menu.kv - Unused menu Kivy file
- menu.py - Unused Menu for the application
- model_predict.py - Custom action detection model, used for testing the model
- model_train.py - Trains the model using data generated by gen_train_data.py
- README.md - This file
- TODO.md - Kanban list featuring User Stories and Technical Debt, shows progress

TODO: add steps in using these files

## Credits

This project uses Nicholas Renotte's excellent video tutorials as a starting point.

- [AI Pose Estimation with Python and MediaPipe | Plus AI Gym Tracker Project](https://youtu.be/06TE_U21FK4?si=fEvcyFsy5oCH_1Bi)
- [Sign Language Detection using ACTION RECOGNITION with Python | LSTM Deep Learning Model](https://youtu.be/doDUihpj6ro?si=OIXOzqfqkaC-Qj7d)
- [Build a Python Facial Recognition App with Tensorflow and Kivy](https://youtu.be/LKispFFQ5GU?si=gScmrokA6cYNjZH7)

As well as using some of the information found in Jonathan Roux's incredible Kivy Course.

- [Kivy Course - Create Python Games and Mobile Apps](https://youtu.be/l8Imtec4ReQ?si=6Tymt6xFJMLYl5gT)

## License

GNU General Public License v3.0
